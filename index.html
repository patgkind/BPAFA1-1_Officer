<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>BPAFA 1-1 Officer Nomination</title>
<style>
  body { font-family: system-ui, -apple-system, "Segoe UI", Roboto, Arial; padding: 18px; max-width: 760px; margin: auto; }
  h1 { margin-bottom: 6px; }
  .card { border: 1px solid #e0e0e0; border-radius: 8px; padding: 12px; margin: 10px 0; background: #fff; box-shadow: 0 1px 0 rgba(0,0,0,0.03); }
  label { display:block; font-weight:600; margin-bottom:6px; }
  input[type="text"] {
    width:100%; padding:8px; border-radius:6px; border:1px solid #d0d0d0; box-sizing:border-box;
  }
  button { padding:10px 14px; border-radius:8px; background:#1976d2; color:white; border:none; cursor:pointer; font-weight:600; }
  button[disabled] { opacity:0.6; cursor:not-allowed; }
  .success { color:green; margin-top:10px; }
  .error { color:#b00020; margin-top:10px; }
  .muted { color:#666; font-size:0.9em; }
</style>
</head>
<body>
  <h1>BPAFA 1-1 Officer Nomination</h1>
  <p class="muted">Fill each position with the nominee's full name, then submit once.</p>

  <form id="nomForm" autocomplete="off">
    <div id="positionsContainer"></div>
    <div style="margin-top:12px; display:flex; gap:8px; align-items:center;">
      <button id="submitBtn" type="submit">Submit nominations</button>
      <div id="status" class="muted"></div>
    </div>
  </form>

  <datalist id="nameSuggestions">
    <!-- Options generated by JS -->
  </datalist>

<script>
  const SCRIPT_URL = 'https://script.google.com/macros/s/AKfycbxWubZoUo6cgyZ0zO7R96YFLscrz4ZYjEl0NQrOfpSH4iRoGOA4cd29P9D00AGratoP/exec';

  const POSITIONS = ['President', 'Vice President', 'Secretary', 'Treasurer', 'Auditor', 'P.I.O', 'Pubmat 1', 'Pubmat 2'];

  const NAME_SUGGESTIONS = [
    "Princess Erika Aguanza",
    "Eric Jan Helterbrand Ancheta",
    "Reziel Ante",
    "Krys Nicole Barlizo",
    "Ronald Justin Bautista",
    "Antonio Bello",
    "Romielyn Cano",
    "Gerlyn Catibog",
    "Ma. Fatima Catungal",
    "Jessadel Codillo",
    "Gemelie Combis",
    "Ma. Sofia De Guzman",
    "Yvonne Deguera",
    "Jake Dela Cruz",
    "Ma. Regine Dela Cruz",
    "Marvin Joyce DiÃ±o",
    "Apelina Disuyo",
    "Dave Dominguez",
    "Ma. Victoria Rosalina Ebrada",
    "Gizelle Joy Ellado",
    "Carlo Martin Garcia",
    "Kathleen Gatela",
    "Stephen Andrew Handog",
    "Rene Jushua Ilagan",
    "Michelle Laguna",
    "Dhenzel Luansing",
    "Judilyn Masibag",
    "Jennifer Narral",
    "Ed Operario",
    "Jessica Pabillon",
    "Christine Joy Palattao",
    "Cristina Ramos",
    "Ma. Editha Rance",
    "Joanne Recella",
    "Karmela Chelein Reyes",
    "Mary Joy Ricalcar",
    "May Salangsang",
    "Mariel Sebulba",
    "Angelou Silvestre",
    "Rie Mie Tandoy",
    "Ma. Editha Umali",
    "Hannah Mae Valles",
    "Jose Velasco Jr.",
    "Christian Victoria",
    "Brigette Villegas",
    "Sara Isabel Yap"
  ];

  const container = document.getElementById('positionsContainer');
  const datalist = document.getElementById('nameSuggestions');

  // Populate datalist options
  NAME_SUGGESTIONS.forEach(name => {
    const option = document.createElement('option');
    option.value = name;
    datalist.appendChild(option);
  });

  POSITIONS.forEach(pos => {
    const card = document.createElement('div');
    card.className = 'card';

    const label = document.createElement('label');
    label.textContent = pos + ' *';

    const input = document.createElement('input');
    input.type = 'text';
    input.name = pos;
    input.placeholder = 'Nominee full name';
    input.required = true;
    input.maxLength = 150;
    input.setAttribute('list', 'nameSuggestions');

    card.appendChild(label);
    card.appendChild(input);
    container.appendChild(card);
  });

  const form = document.getElementById('nomForm');
  const status = document.getElementById('status');
  const submitBtn = document.getElementById('submitBtn');

  function setStatus(text, cls) {
    status.textContent = text || '';
    status.className = cls || 'muted';
  }

  function duplicatesExist(values) {
    const seen = {};
    for (const v of values) {
      const key = (v || '').toLowerCase().trim();
      if (!key || key === 'n/a') continue;
      if (seen[key]) return true;
      seen[key] = true;
    }
    return false;
  }

  form.addEventListener('submit', async (ev) => {
    ev.preventDefault();
    setStatus('', 'muted');

    const inputs = Array.from(container.querySelectorAll('input'));
    const values = inputs.map(i => i.value.trim());

    if (values.some(v => v === '')) {
      setStatus('Fill all nominee name fields, or put "N/A"', 'error');
      return;
    }

    if (duplicatesExist(values)) {
      setStatus('Duplicate nominee found across positions', 'error');
      return;
    }

    submitBtn.disabled = true;
    setStatus('Submitting...', 'muted');

    const formData = new URLSearchParams();
    POSITIONS.forEach((pos, i) => {
      formData.append(pos, values[i]);
    });

    try {
      const resp = await fetch(SCRIPT_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/x-www-form-urlencoded' },
        body: formData.toString(),
      });

      const text = await resp.text();

      if (text === 'Success') {
        setStatus('Nominations submitted, thank you', 'success');
        submitBtn.disabled = true;
      } else {
        setStatus('Server error: ' + text, 'error');
        submitBtn.disabled = false;
      }
    } catch (err) {
      setStatus('Network error: ' + err.message, 'error');
      submitBtn.disabled = false;
    }
  });
</script>
</body>
</html>

